<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>게시글 상세</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body { margin-bottom: 70px; padding: 20px; }
        .comment-box { margin-top: 30px; }
        .comment { padding: 10px; border-bottom: 1px solid #ddd; }
        .comment strong { display: block; color: #333; }
        .comment-form input { width: 100%; padding: 8px; margin-bottom: 10px; }
    </style>
</head>
<body>
<a href="/board" class="btn btn-link mb-3">← 목록</a>

<h3 th:text="${post.user.nickname != null ? post.user.nickname : post.user.email} + '의 게시물'">작성자</h3>

<img th:if="${post.imageUrl != null}" th:src="${post.imageUrl}" class="img-fluid mb-3" style="max-width: 100%; height: auto;">

<p th:text="${post.content}">게시글 내용</p>

<p class="text-muted" th:text="'위치: ' + ${post.location}"></p>
<p class="text-muted" th:text="'해시태그: ' + ${post.hashtags}"></p>
<p class="text-muted" th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd HH:mm')}"></p>

<hr>

<!-- 댓글 목록 -->
<div class="comment-box">
    <h5>💬 댓글</h5>
    <div th:if="${#lists.isEmpty(comments)}">
        <p class="text-muted">아직 댓글이 없습니다. 첫 댓글을 남겨보세요!</p>
    </div>
    <div th:each="comment : ${comments}" class="comment">
        <strong th:text="${comment.user.nickname != null ? comment.user.nickname : comment.user.email}">작성자</strong>
        <p th:text="${comment.content}">댓글 내용</p>
        <p class="text-muted" style="font-size: 0.8rem;" th:text="${#temporals.format(comment.createdAt, 'yyyy-MM-dd HH:mm')}"></p>
    </div>
</div>

<!-- 댓글 작성 폼 -->
<form th:action="@{/board/{postId}/comment(postId=${post.id})}" method="post" class="comment-form mt-4">
    <div class="form-group">
        <input type="text" name="content" class="form-control" placeholder="댓글을 입력하세요..." required>
    </div>
    <button type="submit" class="btn btn-sm btn-primary">댓글 등록</button>
</form>

<!-- 하단 네비게이션 -->
<div th:replace="~{fragments/nav :: bottom('board')}"></div>
</body>
</html>
